<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Google Geminiを活用して既存のGASやExcelマクロをレビュー・改善する方法。手作りスクリプトの処理効率を30%向上させた事例を解説します。">
    <meta name="keywords" content="Gemini, GAS, Excel VBA, コードレビュー, リファクタリング, 業務効率化, 中小企業DX">
    <title>Geminiで既存スクリプトをAIレビュー！処理効率30%改善の実践術 | デジタルツール研究所</title>
</head>
<body>
    <article>
        <header>
            <h1>Geminiで既存スクリプトをAIレビュー！処理効率30%改善の実践術</h1>
            <p class="lead">20名規模の会計事務所が、Google Geminiを活用して既存のGAS・Excelマクロをレビュー・改善。手作業で作ったスクリプトの処理ステップを30%削減し、業務効率を大幅に向上させた事例をご紹介します。</p>
        </header>

        <nav class="toc">
            <h2>目次</h2>
            <ol>
                <li><a href="#challenge">課題：手作りスクリプトが複雑化して保守困難に</a></li>
                <li><a href="#solution">施策：GeminiでスクリプトをAIレビュー</a></li>
                <li><a href="#result">成果：処理ステップを30%削減</a></li>
                <li><a href="#summary">まとめ：AIで「技術的負債」を解消</a></li>
            </ol>
        </nav>

        <section id="challenge">
            <h2>課題：手作りスクリプトが複雑化して保守困難に</h2>

            <h3>企業プロフィール</h3>
            <table>
                <tr>
                    <th>業種</th>
                    <td>会計事務所</td>
                </tr>
                <tr>
                    <th>従業員数</th>
                    <td>20名</td>
                </tr>
                <tr>
                    <th>顧問先数</th>
                    <td>約150社</td>
                </tr>
                <tr>
                    <th>主な課題</th>
                    <td>長年使ってきたスクリプトが複雑化し、改修・保守が困難</td>
                </tr>
            </table>

            <h3>自動化スクリプトの現状</h3>
            <p>同事務所では、業務効率化のために複数のGASやExcelマクロを活用しています。しかし、これらは「必要に応じてその都度追加」してきたため、様々な問題が生じていました。</p>

            <h4>主な自動化スクリプト</h4>
            <ul>
                <li><strong>請求書自動発行スクリプト（GAS）</strong>：顧問先への請求書をGoogleスプレッドシートから自動生成</li>
                <li><strong>データ集計マクロ（Excel VBA）</strong>：月次決算データの集計・転記</li>
                <li><strong>メール送信スクリプト（GAS）</strong>：顧問先への定期連絡の自動送信</li>
            </ul>

            <h4>発生していた問題</h4>
            <ul>
                <li><strong>処理が遅い</strong>：追加を繰り返した結果、無駄な処理ステップが多い</li>
                <li><strong>手作業が残っている</strong>：完全自動化できておらず、一部で担当者の作業が必要</li>
                <li><strong>エラーが発生しやすい</strong>：条件分岐が複雑になり、予期しないエラーが起きる</li>
                <li><strong>改修が難しい</strong>：コードが読みにくく、修正すると別の場所が壊れる</li>
                <li><strong>属人化</strong>：作った本人しか中身を理解していない</li>
            </ul>

            <div class="problem-box">
                <h4>請求書発行スクリプトの例</h4>
                <ul>
                    <li>処理ステップ数：約150行のコード</li>
                    <li>実行時間：顧問先150社分で約15分</li>
                    <li>手作業の介入：3箇所（データ確認、送信前チェック、例外処理）</li>
                    <li>エラー発生頻度：月に2〜3回</li>
                </ul>
            </div>

            <h4>担当者の声（導入前）</h4>
            <blockquote>
                <p>「数年前に自分で作ったスクリプトなんですが、その場しのぎで継ぎ足してきたので、今では自分でも全体像を把握しきれていません。直したいけど、どこから手をつけていいか分からない状態でした」</p>
                <cite>— 経理担当者（入社8年目）</cite>
            </blockquote>
        </section>

        <section id="solution">
            <h2>施策：GeminiでスクリプトをAIレビュー</h2>

            <h3>Geminiを選んだ理由</h3>
            <p>同事務所がGeminiを選んだ理由は、既にGoogle Workspaceを利用しており、GASとの親和性が高かったためです。また、長いコードを一度に解析できる大容量のコンテキストウィンドウも魅力でした。</p>

            <h3>活用方法1：既存コードの問題点を診断</h3>
            <p>まず、既存のスクリプトをGeminiに読み込ませ、問題点を指摘してもらいます。</p>

            <div class="prompt-example">
                <h4>コードレビュー依頼のプロンプト例</h4>
                <pre>
以下のGASコードをレビューして、改善点を指摘してください。

【観点】
1. 処理効率の悪い部分
2. エラーが発生しやすい部分
3. 可読性を損なっている部分
4. 重複している処理
5. より良い書き方があれば提案

【コード】
function createInvoices() {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('顧問先一覧');
  var data = sheet.getDataRange().getValues();

  for (var i = 1; i < data.length; i++) {
    var clientName = data[i][0];
    var fee = data[i][1];
    // 以下、請求書作成処理...

    // [実際のコードを貼り付け]
  }
}
                </pre>
            </div>

            <h4>Geminiからの指摘例</h4>
            <div class="output-example">
                <h5>レビュー結果</h5>
                <p><strong>1. 処理効率の問題</strong></p>
                <ul>
                    <li>ループ内で毎回 <code>getValues()</code> を呼んでいるため、API呼び出しが多い → ループ外で一度だけ取得すべき</li>
                    <li>日付計算を毎回行っている → 定数として定義すべき</li>
                </ul>

                <p><strong>2. エラーリスク</strong></p>
                <ul>
                    <li>データが空の場合の処理がない → null/undefinedチェックを追加</li>
                    <li>try-catchがない → エラー時に全処理が停止するリスク</li>
                </ul>

                <p><strong>3. 可読性の問題</strong></p>
                <ul>
                    <li>マジックナンバー（[0], [1]等）が多い → 定数で列名を定義すべき</li>
                    <li>長すぎる関数 → 処理を分割すべき</li>
                </ul>
            </div>

            <h3>活用方法2：改善版コードの生成</h3>
            <p>問題点を把握したら、Geminiに改善版のコードを生成してもらいます。</p>

            <div class="prompt-example">
                <h4>リファクタリング依頼のプロンプト例</h4>
                <pre>
先ほど指摘された問題点を踏まえて、以下の改善を行ったコードに書き換えてください。

【改善要件】
1. API呼び出しを最小限に
2. エラーハンドリングを追加
3. 可読性の向上（定数定義、関数分割）
4. コメントを追加して処理内容を明確に
5. 既存の機能は維持すること

【出力形式】
- 改善後のコード全文
- 主な変更点の説明
- 期待される効果
                </pre>
            </div>

            <h4>Geminiが生成した改善版コード（抜粋）</h4>
            <div class="code-example">
                <pre>
// 定数定義（列インデックス）
const COLUMNS = {
  CLIENT_NAME: 0,
  FEE: 1,
  EMAIL: 2,
  // ...
};

/**
 * 請求書を一括作成するメイン関数
 */
function createInvoices() {
  const sheet = SpreadsheetApp.getActiveSpreadsheet()
                             .getSheetByName('顧問先一覧');
  const data = sheet.getDataRange().getValues();
  const today = new Date();

  // ヘッダー行をスキップ
  const clients = data.slice(1).filter(row => row[COLUMNS.CLIENT_NAME]);

  const results = { success: 0, failed: 0, errors: [] };

  clients.forEach((client, index) => {
    try {
      createSingleInvoice(client, today);
      results.success++;
    } catch (error) {
      results.failed++;
      results.errors.push({
        client: client[COLUMNS.CLIENT_NAME],
        error: error.message
      });
      Logger.log(`Error for ${client[COLUMNS.CLIENT_NAME]}: ${error}`);
    }
  });

  // 結果サマリーをログ出力
  Logger.log(`完了: 成功${results.success}件, 失敗${results.failed}件`);
  return results;
}

/**
 * 単一の請求書を作成
 */
function createSingleInvoice(clientData, issueDate) {
  // 請求書作成処理...
}
                </pre>
            </div>

            <h3>活用方法3：手作業部分の自動化提案</h3>
            <p>現在手作業で行っている部分を説明し、自動化できないか相談します。</p>

            <div class="prompt-example">
                <h4>自動化相談のプロンプト例</h4>
                <pre>
現在、以下の部分で手作業が発生しています。
これらを自動化する方法を提案してください。

【手作業の内容】
1. 請求書発行前に、顧問料が変更された顧客がないか確認
2. 送信前に、メールアドレスが空欄の顧客を除外
3. エラーが出た顧客を手動でリストアップ

【制約】
- GASで実現可能な方法
- 既存のデータ構造は変えたくない
                </pre>
            </div>

            <h3>段階的な改善アプローチ</h3>
            <p>一度にすべてを改修するのではなく、段階的に改善を進めました。</p>

            <ol>
                <li><strong>Phase 1: 診断</strong>：既存コードの問題点を洗い出し</li>
                <li><strong>Phase 2: 軽微な改善</strong>：影響の少ない部分から修正</li>
                <li><strong>Phase 3: リファクタリング</strong>：コード構造の整理</li>
                <li><strong>Phase 4: 自動化拡張</strong>：手作業部分の自動化</li>
            </ol>

            <h3>運用上の注意点</h3>

            <h4>本番適用前のテスト</h4>
            <ul>
                <li>テスト用のスプレッドシートで動作確認</li>
                <li>少数のデータで試運転</li>
                <li>旧バージョンのバックアップを保持</li>
            </ul>

            <h4>AIの出力を鵜呑みにしない</h4>
            <ul>
                <li>生成されたコードは必ず動作確認</li>
                <li>既存機能が壊れていないかチェック</li>
                <li>不明な部分は追加で質問</li>
            </ul>
        </section>

        <section id="result">
            <h2>成果：処理ステップを30%削減</h2>

            <h3>定量的な成果（請求書発行スクリプト）</h3>
            <table class="result-table">
                <tr>
                    <th>指標</th>
                    <th>改善前</th>
                    <th>改善後</th>
                    <th>改善率</th>
                </tr>
                <tr>
                    <td>コード行数</td>
                    <td>約150行</td>
                    <td>約100行</td>
                    <td>33%削減</td>
                </tr>
                <tr>
                    <td>実行時間（150社分）</td>
                    <td>約15分</td>
                    <td>約10分</td>
                    <td>33%短縮</td>
                </tr>
                <tr>
                    <td>手作業の介入箇所</td>
                    <td>3箇所</td>
                    <td>0箇所</td>
                    <td>完全自動化</td>
                </tr>
                <tr>
                    <td>月間エラー発生数</td>
                    <td>2〜3回</td>
                    <td>0〜1回</td>
                    <td>大幅減少</td>
                </tr>
            </table>

            <h3>他のスクリプトへの展開</h3>
            <p>請求書発行スクリプトでの成功を受けて、他のスクリプトも同様に改善しました。</p>
            <table>
                <tr>
                    <th>スクリプト</th>
                    <th>処理時間</th>
                    <th>手作業</th>
                </tr>
                <tr>
                    <td>データ集計マクロ</td>
                    <td>20分→12分</td>
                    <td>2箇所→0箇所</td>
                </tr>
                <tr>
                    <td>メール送信スクリプト</td>
                    <td>10分→7分</td>
                    <td>1箇所→0箇所</td>
                </tr>
            </table>

            <h3>年間での効果</h3>
            <div class="highlight-box">
                <ul>
                    <li>スクリプト実行時間の短縮：<strong>年間約50時間削減</strong></li>
                    <li>手作業の削減：<strong>年間約30時間削減</strong></li>
                    <li>エラー対応工数の削減：<strong>年間約10時間削減</strong></li>
                    <li>合計：<strong>年間約90時間の業務削減</strong></li>
                </ul>
            </div>

            <h3>定性的な成果</h3>

            <h4>保守性の向上</h4>
            <ul>
                <li><strong>コードが読みやすくなった</strong>：誰でも内容を理解できるように</li>
                <li><strong>修正が怖くなくなった</strong>：構造化されたことで影響範囲が明確に</li>
                <li><strong>ドキュメント化</strong>：コメントが充実し、引継ぎが容易に</li>
            </ul>

            <h4>安定性の向上</h4>
            <ul>
                <li><strong>エラーが減少</strong>：適切なエラーハンドリングにより、予期しないエラーが減った</li>
                <li><strong>エラー時の対応が容易</strong>：どこで何が起きたかログで分かる</li>
                <li><strong>手作業によるミスがなくなった</strong>：完全自動化による品質安定</li>
            </ul>

            <h4>組織としての成長</h4>
            <ul>
                <li><strong>AIを活用したコード改善のノウハウ蓄積</strong></li>
                <li><strong>他のスタッフも改善に参加</strong>：AIがあれば専門知識がなくても相談できる</li>
                <li><strong>新しいスクリプト作成時の品質向上</strong>：最初からAIにレビューしてもらう習慣</li>
            </ul>

            <h3>担当者の声（導入後）</h3>
            <blockquote>
                <p>「既存のコードをAIに見せるだけで、改善点を的確に指摘し、より洗練されたコードに書き換えてくれることに驚きました。コードの品質向上と効率化を同時に実現できました」</p>
                <cite>— 経理担当者（入社8年目）</cite>
            </blockquote>

            <blockquote>
                <p>「自分で作ったスクリプトの『技術的負債』をずっと気にしていたんですが、一人で直すのは難しかった。AIに相談しながら進められたことで、ようやく解消できました」</p>
                <cite>— 所長</cite>
            </blockquote>
        </section>

        <section id="summary">
            <h2>まとめ：AIで「技術的負債」を解消</h2>

            <h3>成功のポイント</h3>
            <ol>
                <li><strong>段階的に改善する</strong>
                    <p>一度に全てを変えるのではなく、影響の少ない部分から段階的に改善しました。</p>
                </li>
                <li><strong>診断から始める</strong>
                    <p>いきなり書き換えるのではなく、まず問題点を明確にしてから改善しました。</p>
                </li>
                <li><strong>テストを徹底する</strong>
                    <p>AIが生成したコードも、必ず動作確認してから本番適用しました。</p>
                </li>
                <li><strong>既存機能を維持する</strong>
                    <p>改善によって既存の機能が失われないよう、要件を明確に伝えました。</p>
                </li>
            </ol>

            <h3>他業種への応用</h3>
            <p>「既存スクリプトのAIレビュー」は、様々な企業で応用可能です。</p>
            <ul>
                <li><strong>営業部門</strong>：見積作成マクロ、CRM連携スクリプト</li>
                <li><strong>人事部門</strong>：勤怠集計マクロ、給与計算シート</li>
                <li><strong>総務部門</strong>：備品管理、経費精算の自動化スクリプト</li>
                <li><strong>マーケティング</strong>：レポート自動生成、データ集計</li>
            </ul>

            <h3>AIを活用したコード改善の進め方</h3>
            <ol>
                <li><strong>対象スクリプトの選定</strong>：問題が多いもの、よく使うものから</li>
                <li><strong>現状の問題点を整理</strong>：処理時間、エラー頻度、手作業箇所</li>
                <li><strong>AIに診断を依頼</strong>：改善点を洗い出してもらう</li>
                <li><strong>優先度をつけて改善</strong>：効果が大きいものから着手</li>
                <li><strong>テストと検証</strong>：動作確認後に本番適用</li>
            </ol>

            <h3>導入を検討される企業様へ</h3>
            <div class="cta-box">
                <p>Geminiを活用したスクリプト改善について、詳しいご相談を承っております。</p>
                <ul>
                    <li>既存スクリプトの診断・改善提案</li>
                    <li>GAS・Excel VBAの効率化支援</li>
                    <li>AIを活用したコード品質向上の研修</li>
                </ul>
                <p>まずはお気軽にお問い合わせください。</p>
            </div>

            <h3>関連記事</h3>
            <ul>
                <li><a href="ai-gemini-gas-file-rename.html">Gemini×GASでファイル名を自動変更！手作業から解放</a></li>
                <li><a href="ai-gemini-meeting-summary-slack.html">Gemini×GASで議事録を自動要約！Slack共有まで完全自動化</a></li>
                <li><a href="ai-gemini-report-automation.html">Geminiで報告資料を自動作成！情報収集から要約まで一気に効率化</a></li>
            </ul>
        </section>

        <footer>
            <p class="update-date">最終更新日：2025年1月</p>
            <p class="category">カテゴリ：AI活用事例 / コード改善 / 業務自動化</p>
            <p class="tags">タグ：#Gemini #GAS #コードレビュー #リファクタリング #中小企業DX</p>
        </footer>
    </article>
</body>
</html>
